# Bug与优化跟踪

## 问题列表
| 类型       | 描述                                   | 优先级 | 状态       |
|------------|----------------------------------------|--------|------------|
| **Bug**    | 重新打开AI问答界面，历史聊天记录丢失   | 高     | 未开始     |
| **Bug**    | 令牌过期后，未自动跳转到登录界面       | 高     | 未开始     |
| **优化需求** | 知识库隔离 | 高     | 未开始     |


## 详细代办步骤
### 1. Bug：重新打开AI问答界面，历史聊天记录丢失
- [ ] 设计聊天记录数据库表（字段：id、user_id、session_id、content、create_time）
- [ ] 后端开发聊天记录的“新增/查询”接口
- [ ] 前端在AI问答界面加载时，调用“查询历史记录”接口并渲染


### 2. Bug：令牌过期后，未自动跳转到登录界面
- [ ] 后端接口统一拦截Token过期异常，返回特定状态码（如401）
- [ ] 前端封装响应拦截器，捕获401状态码
- [ ] 配置前端路由守卫，收到401后自动跳转到登录页


### 3. 优化需求：知识库隔离
- [ ] 知识库表新增`user_id`字段，关联用户表
- [ ] 知识库的CRUD接口增加`user_id`参数，过滤当前用户数据
- [ ] RAG检索逻辑中，添加`user_id`条件，仅检索当前用户的知识库


### 4. 优化需求：功能/界面优化
- [ ] 「我的知识库」界面增加“新建/删除/批量上传”按钮
- [ ] 「AI问答」界面增加“选择知识库”下拉选择器
- [ ] 调整界面布局（如聊天记录区域高度、按钮样式）